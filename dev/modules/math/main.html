<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<!--[if IE]><meta http-equiv="X-UA-Compatible" content="IE=edge"><![endif]-->
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="generator" content="Asciidoctor 1.5.6.1">
<title>Math</title>
<link rel="stylesheet" href="/udoc/css/main.css">
</head>
<body class="article toc2 toc-left">
<div id="header">
<h1>Math</h1>
<div id="toc" class="toc2">
<div id="toctitle">Table of Contents</div>
<ul class="sectlevel1">
<li><a href="#_linal">linal</a>
<ul class="sectlevel2">
<li><a href="#_interface">interface</a></li>
</ul>
</li>
<li><a href="#_host_random_number_generation">Host random number generation</a>
<ul class="sectlevel2">
<li><a href="#_interface_2">interface</a></li>
</ul>
</li>
<li><a href="#_linar_coordinate_transformation_for_3d_vector">linar coordinate transformation for 3D vector</a>
<ul class="sectlevel2">
<li><a href="#_interface_3">interface</a></li>
</ul>
</li>
</ul>
</div>
</div>
<div id="content">
<div id="preamble">
<div class="sectionbody">
<div class="paragraph">
<p>Helpers for math operations and random number generation</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_linal">linal</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Linear algebra helpers on host</p>
</div>
<div class="sect2">
<h3 id="_interface">interface</h3>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="cpp"><span style="color:#777">/* invert symmetric matrix m0[6] */</span>
<span style="color:#088;font-weight:bold">void</span> linal_inv3x3(<span style="color:#088;font-weight:bold">const</span> <span style="color:#0a8;font-weight:bold">float</span> *m0, <span style="color:#777">/**/</span> <span style="color:#0a8;font-weight:bold">float</span> *minv0); <b class="conum">(1)</b></code></pre>
</div>
</div>
<div class="colist arabic">
<ol>
<li>
<p>inverse symmetric 3 by 3 matrix; fails and returns an error for
singular matrices with determinant smaller than epsilon (hardcoded
to <code>1e-8</code>).</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>structure of the matrix is <code>xx, xy, yy, yz, zz</code>, where</p>
</div>
<div class="listingblock">
<div class="content">
<pre>     ( xx xy xz)
A =  ( xy yy yz)
     ( xz yz zz)</pre>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_host_random_number_generation">Host random number generation</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Generate uniform random numbers on host in floating point precision</p>
</div>
<div class="sect2">
<h3 id="_interface_2">interface</h3>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="cpp"><span style="color:#080;font-weight:bold">struct</span> RNDunif;                                             <b class="conum">(1)</b>
<span style="color:#088;font-weight:bold">void</span> rnd_ini(<span style="color:#0a8;font-weight:bold">int</span> x, <span style="color:#0a8;font-weight:bold">int</span> y, <span style="color:#0a8;font-weight:bold">int</span> z, <span style="color:#0a8;font-weight:bold">int</span> c, <span style="color:#777">/**/</span> RNDunif **r); <b class="conum">(2)</b>
<span style="color:#088;font-weight:bold">void</span> rnd_fin(RNDunif *r);                                   <b class="conum">(3)</b>
<span style="color:#0a8;font-weight:bold">float</span> rnd_get(RNDunif *r);                                  <b class="conum">(4)</b></code></pre>
</div>
</div>
<div class="colist arabic">
<ol>
<li>
<p>hidden structure containing state of the rng</p>
</li>
<li>
<p>allocate and initialize the rng (<code>x</code>, <code>y</code>, <code>z</code> and <code>c</code> are states of the rng)</p>
</li>
<li>
<p>deallocate rng states</p>
</li>
<li>
<p>generate a random number in single precision; modify the state</p>
</li>
</ol>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_linar_coordinate_transformation_for_3d_vector">linar coordinate transformation for 3D vector</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Transform vector <code>a[3]</code> to <code>b[3]</code> using</p>
</div>
<div class="listingblock">
<div class="content">
<pre>    b[X] = s[X]*a[X] + o[X]
    b[Y] = s[Y]*a[Y] + o[Y]
    b[Z] = s[Z]*a[Z] + o[Z]</pre>
</div>
</div>
<div class="paragraph">
<p>Coefficient <code>s</code> and <code>o</code> are defined implicitly by API calls.</p>
</div>
<div class="sect2">
<h3 id="_interface_3">interface</h3>
<div class="paragraph">
<p>Allocate/Deallocate</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="cpp"><span style="color:#088;font-weight:bold">void</span> tform_ini(Tform**);
<span style="color:#088;font-weight:bold">void</span> tform_fin(Tform*);</code></pre>
</div>
</div>
<div class="paragraph">
<p>Set parameters of the transformation</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="cpp"><span style="color:#088;font-weight:bold">void</span> tform_vector(<span style="color:#088;font-weight:bold">const</span> <span style="color:#0a8;font-weight:bold">float</span> a0[<span style="color:#00D">3</span>], <span style="color:#088;font-weight:bold">const</span> <span style="color:#0a8;font-weight:bold">float</span> a1[<span style="color:#00D">3</span>],   <span style="color:#088;font-weight:bold">const</span> <span style="color:#0a8;font-weight:bold">float</span> b0[<span style="color:#00D">3</span>], <span style="color:#088;font-weight:bold">const</span> <span style="color:#0a8;font-weight:bold">float</span> b1[<span style="color:#00D">3</span>], <span style="color:#777">/**/</span> Tform*);
<span style="color:#088;font-weight:bold">void</span> tform_chain(Tform*, Tform*, <span style="color:#777">/**/</span> Tform*);
<span style="color:#088;font-weight:bold">void</span> tform_grid2grid(<span style="color:#088;font-weight:bold">const</span> <span style="color:#0a8;font-weight:bold">float</span> f_lo[<span style="color:#00D">3</span>], <span style="color:#088;font-weight:bold">const</span> <span style="color:#0a8;font-weight:bold">float</span> f_hi[<span style="color:#00D">3</span>], <span style="color:#088;font-weight:bold">const</span> <span style="color:#0a8;font-weight:bold">int</span> f_n[<span style="color:#00D">3</span>],
                     <span style="color:#088;font-weight:bold">const</span> <span style="color:#0a8;font-weight:bold">float</span> t_lo[<span style="color:#00D">3</span>], <span style="color:#088;font-weight:bold">const</span> <span style="color:#0a8;font-weight:bold">float</span> t_hi[<span style="color:#00D">3</span>], <span style="color:#088;font-weight:bold">const</span> <span style="color:#0a8;font-weight:bold">int</span> t_n[<span style="color:#00D">3</span>], <span style="color:#777">/**/</span>
                     Tform*);
<span style="color:#088;font-weight:bold">void</span> tform_to_grid(<span style="color:#088;font-weight:bold">const</span> <span style="color:#0a8;font-weight:bold">float</span> a0[<span style="color:#00D">3</span>], <span style="color:#088;font-weight:bold">const</span> <span style="color:#0a8;font-weight:bold">float</span> b0[<span style="color:#00D">3</span>], <span style="color:#088;font-weight:bold">const</span> <span style="color:#0a8;font-weight:bold">int</span> n[<span style="color:#00D">3</span>], <span style="color:#777">/**/</span> Tform*);
<span style="color:#088;font-weight:bold">void</span> tform_from_grid(<span style="color:#088;font-weight:bold">const</span> <span style="color:#0a8;font-weight:bold">float</span> a0[<span style="color:#00D">3</span>], <span style="color:#088;font-weight:bold">const</span> <span style="color:#0a8;font-weight:bold">float</span> b0[<span style="color:#00D">3</span>], <span style="color:#088;font-weight:bold">const</span> <span style="color:#0a8;font-weight:bold">int</span> n[<span style="color:#00D">3</span>], <span style="color:#777">/**/</span> Tform*);</code></pre>
</div>
</div>
<div class="paragraph">
<p>Convert vector</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="cpp"><span style="color:#088;font-weight:bold">void</span> tform_convert(Tform*, <span style="color:#088;font-weight:bold">const</span> <span style="color:#0a8;font-weight:bold">float</span> a0[<span style="color:#00D">3</span>], <span style="color:#777">/**/</span> <span style="color:#0a8;font-weight:bold">float</span> a1[<span style="color:#00D">3</span>]);</code></pre>
</div>
</div>
<div class="paragraph">
<p>Convert 'Tform*' to 'Tform_v*'</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="cpp"><span style="color:#088;font-weight:bold">void</span> tform_to_view(Tform*, <span style="color:#777">/**/</span> Tform_v*);</code></pre>
</div>
</div>
<div class="paragraph">
<p>Log or dump the state of 'Tform'</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="cpp"><span style="color:#088;font-weight:bold">void</span> tform_log(Tform*);
<span style="color:#088;font-weight:bold">void</span> tform_dump(Tform*, FILE*);</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
</body>
</html>