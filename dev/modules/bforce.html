<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<!--[if IE]><meta http-equiv="X-UA-Compatible" content="IE=edge"><![endif]-->
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="generator" content="Asciidoctor 1.5.6.1">
<title>body forces</title>
<link rel="stylesheet" href="/udoc/css/main.css">
<link rel="stylesheet" href="./pygments-colorful.css">
</head>
<body class="article toc2 toc-left">
<div id="header">
<h1>body forces</h1>
<div id="toc" class="toc2">
<div id="toctitle">Table of Contents</div>
<ul class="sectlevel1">
<li><a href="#_data_structures">1. data structures</a></li>
<li><a href="#_interface">2. interface</a></li>
<li><a href="#_configuration">3. configuration</a>
<ul class="sectlevel2">
<li><a href="#_none">3.1. none</a></li>
<li><a href="#_constant">3.2. constant</a></li>
<li><a href="#_double_poiseuille">3.3. double poiseuille</a></li>
<li><a href="#_shear">3.4. shear</a></li>
<li><a href="#_4_roller_mill">3.5. 4 roller mill</a></li>
<li><a href="#_radial">3.6. radial</a></li>
</ul>
</li>
</ul>
</div>
</div>
<div id="content">
<div id="preamble">
<div class="sectionbody">
<div class="paragraph">
<p>force applied to every particles</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_data_structures">1. data structures</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Defined by two structures:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>BForce</code>, contains all informations needed for the  force
field. It is hold and maintained on host.</p>
</li>
<li>
<p><code>BForce_v</code> (<em>BForce view</em>), containing only the information needed at
a specific time. It is passed to device kernels.</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_interface">2. interface</h2>
<div class="sectionbody">
<div class="paragraph">
<p>allocate/deallocate the structure:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="c++"><span></span><span class="tok-kt">void</span> <span class="tok-nf">bforce_ini</span><span class="tok-p">(</span><span class="tok-n">BForce</span> <span class="tok-o">**</span><span class="tok-n">p</span><span class="tok-p">);</span>
<span class="tok-kt">void</span> <span class="tok-nf">bforce_fin</span><span class="tok-p">(</span><span class="tok-n">BForce</span> <span class="tok-o">*</span><span class="tok-n">p</span><span class="tok-p">);</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>initialize to a given force function:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="c++"><span></span><span class="tok-kt">void</span> <span class="tok-nf">bforce_ini_none</span><span class="tok-p">(</span><span class="tok-cm">/**/</span> <span class="tok-n">BForce</span> <span class="tok-o">*</span><span class="tok-n">p</span><span class="tok-p">);</span>            <b class="conum">(1)</b>
<span class="tok-kt">void</span> <span class="tok-nf">bforce_ini_cste</span><span class="tok-p">(</span><span class="tok-n">float3</span> <span class="tok-n">f</span><span class="tok-p">,</span> <span class="tok-cm">/**/</span> <span class="tok-n">BForce</span> <span class="tok-o">*</span><span class="tok-n">p</span><span class="tok-p">);</span>  <b class="conum">(2)</b>
<span class="tok-kt">void</span> <span class="tok-nf">bforce_ini_dp</span><span class="tok-p">(</span><span class="tok-kt">float</span> <span class="tok-n">a</span><span class="tok-p">,</span> <span class="tok-cm">/**/</span> <span class="tok-n">BForce</span> <span class="tok-o">*</span><span class="tok-n">p</span><span class="tok-p">);</span>     <b class="conum">(3)</b>
<span class="tok-kt">void</span> <span class="tok-nf">bforce_ini_shear</span><span class="tok-p">(</span><span class="tok-kt">float</span> <span class="tok-n">a</span><span class="tok-p">,</span> <span class="tok-cm">/**/</span> <span class="tok-n">BForce</span> <span class="tok-o">*</span><span class="tok-n">p</span><span class="tok-p">);</span>  <b class="conum">(4)</b>
<span class="tok-kt">void</span> <span class="tok-nf">bforce_ini_rol</span><span class="tok-p">(</span><span class="tok-kt">float</span> <span class="tok-n">a</span><span class="tok-p">,</span> <span class="tok-cm">/**/</span> <span class="tok-n">BForce</span> <span class="tok-o">*</span><span class="tok-n">p</span><span class="tok-p">);</span>    <b class="conum">(5)</b>
<span class="tok-kt">void</span> <span class="tok-nf">bforce_ini_rad</span><span class="tok-p">(</span><span class="tok-kt">float</span> <span class="tok-n">a</span><span class="tok-p">,</span> <span class="tok-cm">/**/</span> <span class="tok-n">BForce</span> <span class="tok-o">*</span><span class="tok-n">p</span><span class="tok-p">);</span>    <b class="conum">(6)</b></code></pre>
</div>
</div>
<div class="colist arabic">
<ol>
<li>
<p>no force</p>
</li>
<li>
<p>constant force <code>f</code></p>
</li>
<li>
<p>double poiseuille</p>
</li>
<li>
<p>shear</p>
</li>
<li>
<p>4 roller mill</p>
</li>
<li>
<p>radial force</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>initialize from configuration:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="c++"><span></span><span class="tok-kt">void</span> <span class="tok-nf">bforce_ini_conf</span><span class="tok-p">(</span><span class="tok-k">const</span> <span class="tok-n">Config</span> <span class="tok-o">*</span><span class="tok-n">cfg</span><span class="tok-p">,</span> <span class="tok-cm">/**/</span> <span class="tok-n">BForce</span> <span class="tok-o">*</span><span class="tok-n">bf</span><span class="tok-p">);</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>interface:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="c++"><span></span><span class="tok-kt">void</span> <span class="tok-nf">bforce_adjust</span><span class="tok-p">(</span><span class="tok-n">float3</span> <span class="tok-n">f</span><span class="tok-p">,</span> <span class="tok-cm">/**/</span> <span class="tok-n">BForce</span> <span class="tok-o">*</span><span class="tok-n">fpar</span><span class="tok-p">);</span> <b class="conum">(1)</b>
<span class="tok-kt">void</span> <span class="tok-nf">bforce_apply</span><span class="tok-p">(</span><span class="tok-kt">long</span> <span class="tok-n">it</span><span class="tok-p">,</span> <span class="tok-k">const</span> <span class="tok-n">Coords</span> <span class="tok-o">*</span><span class="tok-n">c</span><span class="tok-p">,</span> <span class="tok-kt">float</span> <span class="tok-n">mass</span><span class="tok-p">,</span> <span class="tok-k">const</span> <span class="tok-n">BForce</span> <span class="tok-o">*</span><span class="tok-n">bf</span><span class="tok-p">,</span> <span class="tok-kt">int</span> <span class="tok-n">n</span><span class="tok-p">,</span> <span class="tok-k">const</span> <span class="tok-n">Particle</span> <span class="tok-o">*</span><span class="tok-n">pp</span><span class="tok-p">,</span> <span class="tok-cm">/**/</span> <span class="tok-n">Force</span> <span class="tok-o">*</span><span class="tok-n">ff</span><span class="tok-p">);</span> <b class="conum">(2)</b></code></pre>
</div>
</div>
<div class="colist arabic">
<ol>
<li>
<p>change value of the force</p>
</li>
<li>
<p>apply body force to particles</p>
</li>
</ol>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_configuration">3. configuration</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_none">3.1. none</h3>
<div class="paragraph">
<p>no body force (default value)</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="cfg"><span></span><span class="tok-na">bforce {</span>
    <span class="tok-na">type</span> <span class="tok-o">=</span> <span class="tok-s">&quot;none&quot;;</span>
<span class="tok-na">};</span></code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_constant">3.2. constant</h3>
<div class="paragraph">
<p>constant force</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="cfg"><span></span><span class="tok-na">bforce {</span>
    <span class="tok-na">type</span> <span class="tok-o">=</span> <span class="tok-s">&quot;constant&quot;;</span>
<span class="tok-s">    f    = [1.0, 0.0, 0.0];</span>
<span class="tok-na">};</span></code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_double_poiseuille">3.3. double poiseuille</h3>
<div class="paragraph">
<p><code>fx = y &gt; yc ? a : -a</code></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="cfg"><span></span><span class="tok-na">bforce {</span>
    <span class="tok-na">type</span> <span class="tok-o">=</span> <span class="tok-s">&quot;double_poiseuille&quot;;</span>
<span class="tok-s">    a    = 1.0;</span>
<span class="tok-na">};</span></code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_shear">3.4. shear</h3>
<div class="paragraph">
<p><code>fx = a * (y - yc)</code></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="cfg"><span></span><span class="tok-na">bforce {</span>
    <span class="tok-na">type</span> <span class="tok-o">=</span> <span class="tok-s">&quot;shear&quot;;</span>
<span class="tok-s">    a    = 1.0;</span>
<span class="tok-na">};</span></code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_4_roller_mill">3.5. 4 roller mill</h3>
<div class="listingblock">
<div class="content">
<pre>    f.x =  2*sin(x)*cos(y) * a;
    f.y = -2*cos(x)*sin(y) * a;</pre>
</div>
</div>
<div class="paragraph">
<p>while <code>x</code> and <code>y</code> are coordinates relative to the domain center and
normalized to have <code>x = Pi</code> and <code>x = -Pi</code> at the domain edges.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="cfg"><span></span><span class="tok-na">bforce {</span>
    <span class="tok-na">type</span> <span class="tok-o">=</span> <span class="tok-s">&quot;four_roller&quot;;</span>
<span class="tok-s">    a    = 1.0;</span>
<span class="tok-na">};</span></code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_radial">3.6. radial</h3>
<div class="paragraph">
<p><code>fr = a * er / r</code>, where <code>fr</code> is radial force, <code>er</code> is unit radial
vector at position <code>r</code> and <code>r</code> is radial position.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="cfg"><span></span><span class="tok-na">bforce {</span>
    <span class="tok-na">type</span> <span class="tok-o">=</span> <span class="tok-s">&quot;rad&quot;;</span>
<span class="tok-s">    a    = 1.0;</span>
<span class="tok-na">};</span></code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
</body>
</html>